---
title: "Determinación de grupos de asignaturas a partir de preferencias de alumnos"
output: html_document
---


## Objetivo

El objetivo principal de esta práctica consiste en construir conjuntos de asignaturas ( conocidas en el argot universitario como materias) que determinen grupos a los cuales se inscriban los alumnos de la carrera de actuaria de la FES Acatlán.

La información con la que se dispone para construir los conjuntos es la preferencia de 124 alumnos (la cual se registró en un formato no normalizado) respecto a las 5 materias que cada uno de ellos elige. 

Como objetivo secundario, pero necesario en la práctica, se identificaron grupos de alumnos con preferencias en común con respecto a su inclinación a las asignaturas.




## Teoría

Para identificar los grupos tanto de alumnos como de materias se empleó el algoritmo $k-means$ y el algoritmo de conglomerados jerárquico ( en este caso se hizo uso de diferentes métodos para realizar la unión entre los conjuntos como el simple, el de “Ward” y el completo).

Dado que el conjunto de datos con el que se trabaja es pequeño, se realizaron varias pruebas con $k-means$ con $k \in \{ 1,2,\dots,124\}$ para observar en qué número de conjuntos la varianza dentro de los grupos decrecía lo suficiente para utilizarla como parámetro de número de grupos de alumnos. Las restricciones del problema establecen que el número de de grupos de alumnos debe de estar entre dos y cinco y como es natural observamos que la varianza intragrupos decrece al incrementar el número de grupos. 


Una vez que se determinó el número grupos se fijó este parámetro, por medio de $k-means$, para utilizar el algoritmo de aglomeración jerárquica  sobre el conjunto de alumnos para formar los grupos. Después sobre cada grupo de alumnos se eligieron las materias preferidas en él. Finalmente se utilizó de nuevo el algoritmo de aglomeración jerárquica sobre el conjunto de asignaturas (fijando nuevamente el parámetro obtenido en primer lugar por medio de $k-means$) para corroborar que las materias preferidas por medio de la metodología son identificadas por este modelo como diferentes a las demás (al ser parte de conjuntos unitarios o de cardinalidad baja y distantes de los demás en el dendograma).


  


## Análisis estadístico

```{r echo = FALSE}
dat1 <- read.csv("eleccciodeoptativas2016grupo2.xlsx - Base completa de eleccion.csv", 
				 dec = ",")

dat2 <- read.csv("eleccciodeoptativas2016grupo2.xlsx - resumen.csv", header = F)[, 1:2]

library(reshape2)

colnames(dat2) <- c("materia", "clave")

dat1 <- na.omit(dat1)
dat2 <- na.omit(dat2)

trainData.pre <- dat1[, c(1, 3:4)]
```

Los datos consisten en 2 tablas, una contiene las preferencias de los alumnos por las materias que eligieron y la otra la lista total de materias con su clave correspondiente.

Se muestra un fragmento de cada tabla:

```{r echo = FALSE}
library(knitr)

kable(head(dat1))
kable(head(dat2))
```

Se puede ver que en la columna de materias no se encuentra en un formato en específico, por lo que deberiamos pensar en utilizar solo las claves, confiando en que el error que un alumno pudiera cometer al saberla y escribirla es mínimo.

Ahora, dada la naturaleza de los datos, no se puede aplicar un Algoritmo de clustering directamente; debemos transformarlos y adecuarlos pasando los nombres de las materias como características: para cada individuo tendremos la preferencia hacia todas las materias.

```{r echo = FALSE}
x <- melt(trainData.pre, id.vars = c("Individuo","Clave")) # Melt previo
encoding <- acast(x, Individuo ~ Clave) # Pasamos las materias como columnas

index <- is.na(encoding) # Buscamos los NA's
encoding[index] <- 0 # Los remplazamos
```

Después de la transformación vemos los primeros renglones de nuestra nueva base:

```{r echo = FALSE}

base.temp <- cbind(data.frame(no.individuo = 1:nrow(encoding)), encoding)

kable(base.temp[1:3, 1:5])

```

## Método

## Conclusiones

## Bibliografía